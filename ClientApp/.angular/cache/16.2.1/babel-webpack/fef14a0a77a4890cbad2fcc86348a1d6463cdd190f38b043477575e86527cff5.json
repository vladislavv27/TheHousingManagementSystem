{"ast":null,"code":"var _class;\nimport { map } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class HomesApiService {\n  constructor(http) {\n    this.http = http;\n    this.apiUrl = 'https://localhost:7281/api';\n  }\n  sendTokenToApi(jwtToken) {\n    // Define the HTTP headers with the token\n    const role = jwtToken.role;\n    const id = jwtToken.residentid; // Update this to match the property name in your request\n    const requestBody = {\n      role: role,\n      id: id\n    };\n    const apiUrl = 'https://localhost:7281/api/residents/profile'; // Replace with your API URL\n    return this.http.post(apiUrl, requestBody);\n  }\n  getAllHouses() {\n    return this.http.get(`${this.apiUrl}/houses`);\n  }\n  getHouseById(id) {\n    return this.http.get(`${this.apiUrl}/houses/${id}`);\n  }\n  getAllApartments() {\n    return this.http.get(`${this.apiUrl}/apartments`);\n  }\n  GetHouseApartments(houseId) {\n    return this.http.get(`${this.apiUrl}/houses/${houseId}/apartments`);\n  }\n  UpdateHouse(id, house) {\n    return this.http.put(`${this.apiUrl}/houses/${id}`, house);\n  }\n  UpdateApartment(id, apartment) {\n    return this.http.put(`${this.apiUrl}/apartments/${id}`, apartment);\n  }\n  GetApartmentById(id) {\n    return this.http.get(`${this.apiUrl}/apartments/${id}`);\n  }\n  GetApartmentsResident(apartmentId) {\n    return this.http.get(`${this.apiUrl}/apartments/${apartmentId}/residents`);\n  }\n  DeleteHouse(id) {\n    return this.http.delete(`${this.apiUrl}/houses/${id}`);\n  }\n  DeleteApartment(id) {\n    return this.http.delete(`${this.apiUrl}/apartments/${id}`);\n  }\n  CreateApartment(apartmentcreate) {\n    apartmentcreate.id = 0;\n    return this.http.post(this.apiUrl + '/apartments', apartmentcreate);\n  }\n  CreateHouse(housecreate) {\n    housecreate.id = 0;\n    return this.http.post(this.apiUrl + '/houses', housecreate);\n  }\n  GetResidentById(id) {\n    return this.http.get(`${this.apiUrl}/residents/${id}`);\n  }\n  DeleteResident(id) {\n    return this.http.delete(`${this.apiUrl}/residents/${id}`);\n  }\n  UpdateResident(id, resident, jwtToken) {\n    const role = jwtToken.role;\n    const residentid = jwtToken.residentid; // Update this to match the property name in your request\n    const requestBody = {\n      role: role,\n      id: residentid\n    };\n    const combinedRequestBody = {\n      ...requestBody,\n      resident: resident\n    };\n    return this.http.put(`${this.apiUrl}/residents/${id}`, combinedRequestBody);\n  }\n  CreateResident(residentcreate) {\n    residentcreate.id = 0;\n    return this.http.post(this.apiUrl + '/residents', residentcreate);\n  }\n  doesHouseExistByNumber(houseNumber) {\n    return this.getAllHouses().pipe(map(houses => houses.some(house => house.number === houseNumber)));\n  }\n  doesApartmentExistByNumber(apartmentNumber, houseId) {\n    return this.GetHouseApartments(houseId).pipe(map(apartment => apartment.some(apartment => apartment.number === apartmentNumber)));\n  }\n  doesResidentExistByNumber(personalcode, apartmentNumber) {\n    return this.GetApartmentsResident(apartmentNumber).pipe(map(resdident => resdident.some(resdident => resdident.personalCode === personalcode)));\n  }\n}\n_class = HomesApiService;\n_class.ɵfac = function HomesApiService_Factory(t) {\n  return new (t || _class)(i0.ɵɵinject(i1.HttpClient));\n};\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["map","HomesApiService","constructor","http","apiUrl","sendTokenToApi","jwtToken","role","id","residentid","requestBody","post","getAllHouses","get","getHouseById","getAllApartments","GetHouseApartments","houseId","UpdateHouse","house","put","UpdateApartment","apartment","GetApartmentById","GetApartmentsResident","apartmentId","DeleteHouse","delete","DeleteApartment","CreateApartment","apartmentcreate","CreateHouse","housecreate","GetResidentById","DeleteResident","UpdateResident","resident","combinedRequestBody","CreateResident","residentcreate","doesHouseExistByNumber","houseNumber","pipe","houses","some","number","doesApartmentExistByNumber","apartmentNumber","doesResidentExistByNumber","personalcode","resdident","personalCode","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\VladislavMihailov\\source\\repos\\vladislavm-ui\\ClientApp\\src\\app\\Services\\homes-api.service.ts"],"sourcesContent":["import { Resident } from './../Models/resident.model';\nimport { Apartment } from './../Models/apartment.model';\nimport { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Observable, map, tap } from 'rxjs';\nimport { House } from '../Models/house.model';\n@Injectable({\n  providedIn: 'root', // Or specify a module if needed\n})\nexport class HomesApiService {\n\n   private apiUrl= 'https://localhost:7281/api'\n  AuthorizeService: any;\n\n  constructor(private http: HttpClient) {}\n\n  sendTokenToApi(jwtToken: any) {\n    // Define the HTTP headers with the token\n    const role = jwtToken.role;\n    const id = jwtToken.residentid; // Update this to match the property name in your request\n    const requestBody = {\n      role: role,\n      id: id\n    };\n    const apiUrl = 'https://localhost:7281/api/residents/profile'; // Replace with your API URL\n    return this.http.post(apiUrl, requestBody);\n  }\n  getAllHouses(): Observable<House[]> {\n    return this.http.get<House[]>(`${this.apiUrl}/houses`);\n  }\n  getHouseById(id: number): Observable<House> {\n    return this.http.get<House>(`${this.apiUrl}/houses/${id}`);\n  }\n  getAllApartments(): Observable<Apartment[]> {\n    return this.http.get<Apartment[]>(`${this.apiUrl}/apartments`);\n  }\n  \n  GetHouseApartments(houseId: number): Observable<Apartment[]> {\n    return this.http.get<Apartment[]>(`${this.apiUrl}/houses/${houseId}/apartments`);\n  }\n  UpdateHouse(id: number, house: House): Observable<any> {\n    return this.http.put(`${this.apiUrl}/houses/${id}`, house);\n  }\n  UpdateApartment(id: number, apartment: Apartment): Observable<any> {\n    return this.http.put(`${this.apiUrl}/apartments/${id}`, apartment);\n  }\n  GetApartmentById(id: number):Observable<Apartment>{\n    return this.http.get<Apartment>(`${this.apiUrl}/apartments/${id}`);\n\n  }\n  GetApartmentsResident(apartmentId:number):Observable<Resident[]>{\n    return this.http.get<Resident[]>(`${this.apiUrl}/apartments/${apartmentId}/residents`);\n  }\n  DeleteHouse(id: number): Observable<any> {\n    return this.http.delete(`${this.apiUrl}/houses/${id}`);\n  }\n  DeleteApartment(id: number): Observable<any> {\n    return this.http.delete(`${this.apiUrl}/apartments/${id}`);\n  }\n  CreateApartment(apartmentcreate: Apartment):Observable<Apartment>{\n    apartmentcreate.id=0;\n    return this.http.post<Apartment>(this.apiUrl+'/apartments',apartmentcreate);\n  }\n  CreateHouse(housecreate: House):Observable<House>{\n    housecreate.id=0;\n    return this.http.post<House>(this.apiUrl+'/houses',housecreate);\n  }\n  GetResidentById(id: number): Observable<Resident> {\n    return this.http.get<Resident>(`${this.apiUrl}/residents/${id}`);\n  }\n  DeleteResident(id: number): Observable<any> {\n    return this.http.delete(`${this.apiUrl}/residents/${id}`);\n  }\n  UpdateResident(id: number, resident: Resident,jwtToken:any): Observable<any> {\n    const role = jwtToken.role;\n    const residentid = jwtToken.residentid; // Update this to match the property name in your request\n    const requestBody = {\n      role: role,\n      id: residentid\n    };\n    const combinedRequestBody = {\n      ...requestBody,\n      resident: resident\n    };\n    return this.http.put(`${this.apiUrl}/residents/${id}`,combinedRequestBody);\n  }\n  CreateResident(residentcreate: Resident):Observable<Resident>{\n    residentcreate.id=0;\n    return this.http.post<Resident>(this.apiUrl+'/residents',residentcreate);\n  }\n  doesHouseExistByNumber(houseNumber: number): Observable<boolean> {\n    return this.getAllHouses().pipe(map((houses) => houses.some((house) => house.number === houseNumber))\n    );\n  }\n  doesApartmentExistByNumber(apartmentNumber: number,houseId:number): Observable<boolean> {\n    return this.GetHouseApartments(houseId).pipe(map((apartment) => apartment.some((apartment) => apartment.number === apartmentNumber))\n    );\n  }\n  doesResidentExistByNumber(personalcode: string,apartmentNumber:number): Observable<boolean> {\n    return this.GetApartmentsResident(apartmentNumber).pipe(map((resdident) => resdident.some((resdident) => resdident.personalCode === personalcode))\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}